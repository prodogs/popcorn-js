(function(f){var i=function(j,g){j=j||f.nop;g=g||f.nop;return function(){j.apply(this,arguments);g.apply(this,arguments)}};f.player=function(j,g){if(!f[j]){g=g||{};var p=function(k,q,r){r=r||{};var a=new Date/1E3,e=a,b=0,m=0,c=1,l=false,n={},h=typeof k==="string"?f.dom.find(k):k,d={};Object.prototype.__defineGetter__||(d=h||document.createElement("div"));for(var s in h)if(!(s in d))if(typeof h[s]==="object")d[s]=h[s];else if(typeof h[s]==="function")d[s]=function(o){return"length"in h[o]&&!h[o].call?
h[o]:function(){return h[o].apply(h,arguments)}}(s);else f.player.defineProperty(d,s,{get:function(o){return function(){return h[o]}}(s),set:f.nop,configurable:true});var v=function(){a=new Date/1E3;if(!d.paused){d.currentTime+=a-e;d.dispatchEvent("timeupdate");setTimeout(v,10)}e=a};d.play=function(){this.paused=false;if(d.readyState>=4){e=new Date/1E3;d.dispatchEvent("play");v()}};d.pause=function(){this.paused=true;d.dispatchEvent("pause")};f.player.defineProperty(d,"currentTime",{get:function(){return b},
set:function(o){b=+o;d.dispatchEvent("timeupdate");return b},configurable:true});f.player.defineProperty(d,"volume",{get:function(){return c},set:function(o){c=+o;d.dispatchEvent("volumechange");return c},configurable:true});f.player.defineProperty(d,"muted",{get:function(){return l},set:function(o){l=+o;d.dispatchEvent("volumechange");return l},configurable:true});f.player.defineProperty(d,"readyState",{get:function(){return m},set:function(o){return m=o},configurable:true});d.addEventListener=function(o,
u){n[o]||(n[o]=[]);n[o].push(u);return u};d.removeEventListener=function(o,u){var t,w=n[o];if(w){for(t=n[o].length-1;t>=0;t--)u===w[t]&&w.splice(t,1);return u}};d.dispatchEvent=function(o){var u,t=o.type;if(!t){t=o;if(o=f.events.getInterface(t)){u=document.createEvent(o);u.initEvent(t,true,true,window,1)}}if(n[t])for(o=n[t].length-1;o>=0;o--)n[t][o].call(this,u,this)};d.src=q||"";d.duration=0;d.paused=true;d.ended=0;r&&r.events&&f.forEach(r.events,function(o,u){d.addEventListener(u,o,false)});if(g._canPlayType(h.nodeName,
q)!==false)if(g._setup)g._setup.call(d,r);else{d.readyState=4;d.dispatchEvent("loadedmetadata");d.dispatchEvent("loadeddata");d.dispatchEvent("canplaythrough")}else setTimeout(function(){d.dispatchEvent("error")},0);k=new f.p.init(d,r);if(g._teardown)k.destroy=i(k.destroy,function(){g._teardown.call(d,r)});return k};p.canPlayType=g._canPlayType=g._canPlayType||f.nop;f[j]=f.player.registry[j]=p}};f.player.registry={};f.player.defineProperty=Object.defineProperty||function(j,g,p){j.__defineGetter__(g,
p.get||f.nop);j.__defineSetter__(g,p.set||f.nop)};f.player.playerQueue=function(){var j=[],g=false;return{next:function(){g=false;j.shift();j[0]&&j[0]()},add:function(p){j.push(function(){g=true;p&&p()});!g&&j[0]()}}};f.smart=function(j,g,p){var k=typeof j==="string"?f.dom.find(j):j,q,r,a,e,b,m="HTMLVimeoVideoElement HTMLSoundCloudAudioElement HTMLNullVideoElement".split(" ");if(k){g=typeof g==="string"?[g]:g;j=0;for(b=g.length;j<b;j++){q=g[j];for(r=0;r<m.length;r++)if((e=f[m[r]])&&e._canPlaySrc(q)===
"probably"){a=e(k);g=f(a,p);setTimeout(function(){a.src=q},0);return g}for(var c in f.player.registry)if(f.player.registry.hasOwnProperty(c))if(f.player.registry[c].canPlayType(k.nodeName,q))return f[c](k,q,p)}c=f.guid("popcorn-video-");r=document.createElement("div");r.style.width="100%";r.style.height="100%";k.appendChild(r);m='<video id="'+c+'" preload=auto autobuffer>';j=0;for(b=g.length;j<b;j++)m+='<source src="'+g[j]+'">';m+="</video>";r.innerHTML=m;p&&p.events&&p.events.error&&k.addEventListener("error",
p.events.error,false);return f("#"+c,p)}else f.error("Specified target `"+j+"` was not found.")}})(Popcorn);(function(f){document.addEventListener("DOMContentLoaded",function(){var i=document.querySelectorAll("[data-timeline-sources]");f.forEach(i,function(j,g){var p=i[g],k,q,r;if(!p.id)p.id=f.guid("__popcorn");if(p.nodeType&&p.nodeType===1){r=f("#"+p.id);k=(p.getAttribute("data-timeline-sources")||"").split(",");k[0]&&f.forEach(k,function(a){q=a.split("!");if(q.length===1){q=a.match(/(.*)[\/\\]([^\/\\]+\.\w+)$/)[2].split(".");q[0]="parse"+q[1].toUpperCase();q[1]=a}k[0]&&r[q[0]]&&r[q[0]](q[1])});r.autoplay()&&
r.play()}})},false)})(Popcorn);(function(f,i){function j(k){k=typeof k==="string"?k:[k.language,k.region].join("-");var q=k.split("-");return{iso6391:k,language:q[0]||"",region:q[1]||""}}var g=f.navigator,p=j(g.userLanguage||g.language);i.locale={get:function(){return p},set:function(k){p=j(k);i.locale.broadcast();return p},broadcast:function(k){var q=i.instances,r=q.length,a=0,e;for(k=k||"locale:changed";a<r;a++){e=q[a];k in e.data.events&&e.trigger(k)}}}})(this,this.Popcorn);(function(f){var i=Object.prototype.hasOwnProperty;f.parsers={};f.parser=function(j,g,p){if(f.protect.natives.indexOf(j.toLowerCase())>=0)f.error("'"+j+"' is a protected function name");else{if(typeof g==="function"&&!p){p=g;g=""}if(!(typeof p!=="function"||typeof g!=="string")){var k={};k[j]=function(q,r){if(!q)return this;var a=this;f.xhr({url:q,dataType:g,success:function(e){var b,m,c=0;e=p(e).data||[];if(b=e.length){for(;c<b;c++){m=e[c];for(var l in m)i.call(m,l)&&a[l]&&a[l](m[l])}r&&r()}}});
return this};f.extend(f.p,k);return k}}}})(Popcorn);(function(f,i){var j=f.document,g=f.location,p=/:\/\//,k=g.href.replace(g.href.split("/").slice(-1)[0],""),q=function(a,e,b){a=a||0;e=(e||a||0)+1;b=b||1;e=Math.ceil((e-a)/b)||0;var m=0,c=[];for(c.length=e;m<e;){c[m++]=a;a+=b}return c};i.sequence=function(a,e){return new i.sequence.init(a,e)};i.sequence.init=function(a,e){this.parent=j.getElementById(a);this.seqId=i.guid("__sequenced");this.queue=[];this.playlist=[];this.inOuts={ofVideos:[],ofClips:[]};this.dims={width:0,height:0};this.active=0;this.playing=
this.cycling=false;this.times={last:0};this.events={};var b=this,m=0;i.forEach(e,function(c,l){var n=j.createElement("video");n.preload="auto";n.controls=true;n.style.display=l&&"none"||"";n.id=b.seqId+"-"+l;b.queue.push(n);var h=c["in"],d=c.out;b.inOuts.ofVideos.push({"in":h!==undefined&&h||1,out:d!==undefined&&d||0});b.inOuts.ofVideos[l].out=b.inOuts.ofVideos[l].out||b.inOuts.ofVideos[l]["in"]+2;n.src=!p.test(c.src)?k+c.src:c.src;n.setAttribute("data-sequence-owner",a);n.setAttribute("data-sequence-guid",
b.seqId);n.setAttribute("data-sequence-id",l);n.setAttribute("data-sequence-clip",[b.inOuts.ofVideos[l]["in"],b.inOuts.ofVideos[l].out].join(":"));b.parent.appendChild(n);b.playlist.push(i("#"+n.id))});b.inOuts.ofVideos.forEach(function(c){c={"in":m,out:m+(c.out-c["in"])};b.inOuts.ofClips.push(c);m=c.out+1});i.forEach(this.queue,function(c,l){function n(){if(!l){b.dims.width=c.videoWidth;b.dims.height=c.videoHeight}c.currentTime=b.inOuts.ofVideos[l]["in"]-0.5;c.removeEventListener("canplaythrough",
n,false);return true}c.addEventListener("canplaythrough",n,false);c.addEventListener("play",function(){b.playing=true},false);c.addEventListener("pause",function(){b.playing=false},false);c.addEventListener("timeupdate",function(h){h=h.srcElement||h.target;h=+(h.dataset&&h.dataset.sequenceId||h.getAttribute("data-sequence-id"));var d=Math.floor(c.currentTime);if(b.times.last!==d&&h===b.active){b.times.last=d;d===b.inOuts.ofVideos[h].out&&i.sequence.cycle.call(b,h)}},false)});return this};i.sequence.init.prototype=
i.sequence.prototype;i.sequence.cycle=function(a){this.queue||i.error("Popcorn.sequence.cycle is not a public method");var e=this.queue,b=this.inOuts.ofVideos,m=e[a],c=0,l;if(e[a+1])c=a+1;if(e[a+1]){e=e[c];b=b[c];i.extend(e,{width:this.dims.width,height:this.dims.height});l=this.playlist[c];m.pause();this.active=c;this.times.last=b["in"]-1;l.currentTime(b["in"]);l[c?"play":"pause"]();this.trigger("cycle",{position:{previous:a,current:c}});if(c){m.style.display="none";e.style.display=""}this.cycling=
false}else this.playlist[a].pause();return this};var r=["timeupdate","play","pause"];i.extend(i.sequence.prototype,{eq:function(a){return this.playlist[a]},remove:function(){this.parent.innerHTML=null},clip:function(a){return this.inOuts.ofVideos[a]},duration:function(){for(var a=0,e=this.inOuts.ofClips,b=0;b<e.length;b++)a+=e[b].out-e[b]["in"]+1;return a-1},play:function(){this.playlist[this.active].play();return this},exec:function(a,e){var b=this.active;this.inOuts.ofClips.forEach(function(m,c){if(a>=
m["in"]&&a<=m.out)b=c});a+=this.inOuts.ofVideos[b]["in"]-this.inOuts.ofClips[b]["in"];i.addTrackEvent(this.playlist[b],{start:a-1,end:a,_running:false,_natives:{start:e||i.nop,end:i.nop,type:"exec"}});return this},listen:function(a,e){var b=this,m=this.playlist,c=m.length,l=0;if(!e)e=i.nop;if(i.Events.Natives.indexOf(a)>-1)i.forEach(m,function(n){n.listen(a,function(h){h.active=b;if(r.indexOf(a)>-1)e.call(n,h);else++l===c&&e.call(n,h)})});else{this.events[a]||(this.events[a]={});m=e.name||i.guid("__"+
a);this.events[a][m]=e}return this},unlisten:function(){},trigger:function(a,e){var b=this;if(!(i.Events.Natives.indexOf(a)>-1)){this.events[a]&&i.forEach(this.events[a],function(m){m.call(b,{type:a},e)});return this}}});i.forEach(i.manifest,function(a,e){i.sequence.prototype[e]=function(b){var m={},c=[],l,n,h,d,s;for(l=0;l<this.inOuts.ofClips.length;l++){c=this.inOuts.ofClips[l];n=q(c["in"],c.out);h=n.indexOf(b.start);d=n.indexOf(b.end);if(h>-1)m[l]=i.extend({},c,{start:n[h],clipIdx:h});if(d>-1)m[l]=
i.extend({},c,{end:n[d],clipIdx:d})}l=Object.keys(m).map(function(o){return+o});c=q(l[0],l[1]);for(l=0;l<c.length;l++){h={};d=c[l];var v=m[d];if(v){s=this.inOuts.ofVideos[d];n=v.clipIdx;s=q(s["in"],s.out);if(v.start){h.start=s[n];h.end=s[s.length-1]}if(v.end){h.start=s[0];h.end=s[n]}}else{h.start=this.inOuts.ofVideos[d]["in"];h.end=this.inOuts.ofVideos[d].out}this.playlist[d][e](i.extend({},b,h))}return this}})})(this,Popcorn);
